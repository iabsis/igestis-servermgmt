<!-- INCLUDE overall_header.htm -->
<h1>{LANG_ISHARE_Gestion_restore_admin_description_short}</h1>
<h2>{LANG_ISHARE_Gestion_restore_admin_description}</h2>

<link rel="stylesheet" href="{TEMPLATE_URL}/ishare.css" media="screen" type="text/css">
<!-- INCLUDE overall_header2.htm -->

<script type="text/javascript">
show_hide_block('administration_menu');

function p_focused(field)
{
	document.getElementById("p_" + field).className = "p_focused";
}

function p_blur(name)
{
	var p = document.getElementById("p_" + name);
	var span = document.getElementById("span_" + name);
	var field = document.getElementById(name);

	p.className = "";
	
	if(name == "saving_time") {
		var regexp_time = /[0-9]{1,2}:[0-9]{1,2}/;
		if(!regexp_time.test(field.value)) span.innerHTML = "Format is 00:00";
		else span.innerHTML = "{LANG_Valide_field_form}";
	}
	
}

function check_field(name) {
	var p = document.getElementById("p_" + name);
	var span = document.getElementById("span_" + name);
	var field = document.getElementById(name);
	
	if(name == "saving_time") {
		var regexp_time = /^([0-1][0-9]|2[0-3]|[0-9]):([0-5][0-9])$/;
		if(!regexp_time.test(field.value)) span.innerHTML = "Format is 00:00";
		else span.innerHTML = "{LANG_Valide_field_form}";
	}
}

function valid_form() {
	var field = document.getElementById("saving_type");
	var regexp_time = /^([0-1][0-9]|2[0-3]|[0-9]):([0-5][0-9])$/;
	if(!regexp_time.test(field.value)) {
		alert("Incorrect time format");
		field.select();
		return false;
	}
	
	return true;
}

function edit_folder_list(folder) {
	popup(640, 480, "{MODULE_FOLDER_URL}edit_folder_list.php?action=edit&folder_name=" + folder, "no", "yes", "no");
}

function del_folder_list(folder) {
	if(confirm("[LANG_ISHARE_Delete_folder_list_backup} '" + folder + "' {LANG_ISHARE_From_saved_folders} ?")) {
		window.location.href = "{MODULE_FOLDER_URL}updatedb.php?section=config&action=del_folder&folder_name=" + folder + "&page_url={PAGE_URL}";
	}
}

</script>

					
<div class="main-content-top-actions">
	<span class="inner">
				
		<ul class="action_menu">
			<li class="last-row"><a href="javascript:popup(640, 480, '{MODULE_FOLDER_URL}edit_folder_list.php?action=new','no','yes','no')">{LANG_ISHARE_Add_folder_to_save_process}</a></li>
		</ul>
	</span>

</div>


<div class="main-content-footer">
	<span class="inner">		
		<fieldset class="left">
		<div class="upperleft">
			<div class="upperright">
				<div class="lowerleft">
					<div class="lowerright">
						<h5>{LANG_ISHARE_Backup_folder_list}</h5>						
						
						<table class="normal_table" style="margin:20px auto; width:90%">
						<tr>
							<th>{LANG_ISHARE_Folder_name}</th>
							<th style="width:150px">{LANG_Actions}</th>
						</tr>
						<!-- IF FOLDERS_LIST -->
							<!-- BEGIN FOLDERS_LIST -->
							<tr class="{FOLDERS_LIST.CLASS}">
								<td>{FOLDERS_LIST.folder}</td>
								<td>
									<!-- IF FOLDERS_LIST.is_editable --><a href="javascript:edit_folder_list('{FOLDERS_LIST.folder}')"><img alt="Edit"   src="{TEMPLATE_URL}/images/write.png" /></a>
									<a href="javascript:del_folder_list('{FOLDERS_LIST.folder}')"> <img alt="Delete" src="{TEMPLATE_URL}/images/del.gif" /></a>
									<!-- ELSE FOLDERS_LIST -->
									&nbsp;
									<!-- ENDIF FOLDERS_LIST -->
								</td>
							</tr>						
							<!-- END FOLDERS_LIST -->
						<!-- ELSE FOLDERS_LIST -->
						<tr><td colspan="2">{LANG_ISHARE_Folder_not_found}</td></tr>
						<!-- ENDIF FOLDERS_LIST-->
						</table>
					</div>
				</div>
			</div>
		</div>		
		</fieldset>	
		
		<fieldset class="right">
		<div class="upperleft">
			<div class="upperright">
				<div class="lowerleft">
					<div class="lowerright">
						<h5>Plannification de la sauvegarde</h5>						
						
						<form action="{MODULE_FOLDER_URL}updatedb.php" method="post" onsubmit="return valid_form()">
							<input type="hidden" name="section" value="config" />
							<input type="hidden" name="action" value="saving_time" />
							<input type="hidden" name="page_url" value="{PAGE_URL}" />
							
							<p id="p_saving_time">
								<label for="saving_time">Heure de sauvegarde</label>
								<input type="text" name="saving_time" id="saving_time" value="{saving_time}" onfocus="javascript:p_focused(this.name)" onblur="javascript:p_blur(this.name)" onkeyup="javascript:check_field(this.name)" />
								<span class="error_message" id="span_saving_time">Format is 00:00</span>
								<script type="text/javascript">p_blur("saving_time");</script> 
							</p>						
							
							<input type="image" src="{TEMPLATE_URL}images/bt_valider.gif" class="img" />
						</form>
						
						
					</div>
				</div>
			</div>
		</div>		
		</fieldset>	
		
		<hr />
	</span>
</div>
<!-- INCLUDE overall_footer.htm -->